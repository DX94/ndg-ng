<html>
    <head>
        <title>Login Page</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="javascripts/libs/jquery-1.7.min.js"><\/script>')</script>
        <script src="javascripts/libs/jquery.md5.js"></script>
    </head>
    <body>
        <div id="flags">
            <a href="#" class="langSelector" id="en" ><img src="images/flag_eua.jpg"></a>
            <a href="#" class="langSelector" id="pr" ><img src="images/flag_bra.jpg"></a>
            <a href="#" class="langSelector" id="sp" ><img src="images/flag_spa.jpg"></a>
            <a href="#" class="langSelector" id="pl" ><img src="images/flag_pol.jpg"></a>
        </div>

        #{form @Application.authorize(), id:'loginForm'}
        <p>
            #{field 'lang'}
            <input id="selectedLanguage" type="text" name="lang" style="display:none" hidden="true" value="&{'languageId'}"/>
            #{/field}
        </p>
        <p>
            #{field 'Login'}
            <label>&{'views.login.Username'}</label>
            <input id="usernameSubmit" type="text" name="username" />
            #{/field}
        </p>
        <p>
            #{field 'content'}
            <input id="passwordSubmit" style="display:none" hidden="true" type="password" name="password" />
            #{/field}
        </p>
        #{/form}

        <p>
            <label>&{'views.login.password'}</label>
            <input id="passwordInput" type="password" name="passwordText" />
        </p>
        <p>
            <input id="submitLoginButton" type="button" value="&{'views.login.Login'}" />
        </p>

        #{if flash.error}
        <p style="color:red">&{'views.login.badPasswordAlert'}<p>
        #{/if}

        <script>
        var sURL = window.location.pathname;


        $(document).ready(function() {

            $('#submitLoginButton').click(function() {
                loginSubmit()
            });

            $( "#passwordInput" ).bind( 'keypress', function( event ){  if( event.which == 13 ){ loginSubmit(); } } );
            $( "#usernameSubmit" ).bind( 'keypress', function( event ){  if( event.which == 13 ){ loginSubmit(); } } );

            $('.langSelector').click(function() {
               $('#selectedLanguage').val( this.id );
               sURL += "?lang=" + this.id;
               window.location.replace( sURL );
            });
        });

        function loginSubmit() {
            var username = document.getElementById("usernameSubmit").value;
            var pass = document.getElementById("passwordInput").value;
            var hash = $.md5( username + ":NDG:" +  pass );
            document.getElementById("passwordSubmit").value = hash;
            $('#loginForm').submit( );
        }
    </script>
    </body>
</html>